# !/usr/bin/env python
# -*- coding: utf-8 -*-

# è¯¾é¢˜ï¼šæ•°æ®æå–ä¹‹jsonæ¨¡å—äºjsonpathæ¨¡å—

# 1.çˆ¬è™«ä¸­æ•°æ®çš„åˆ†ç±»
# ç»“æ„åŒ–æ•°æ®ï¼š
# json
# éç»“æ„åŒ–æ•°æ®ï¼š
# html

# 2.jsonæ¨¡å—æ–¹æ³•
import json

dict_1 = {'name': 'é˜¿å±•', 'gender': 'ç”·'}

# ç†Ÿæ‚‰
# print(json.dumps(dict_1))
# result = json.dumps(dict_1)
# print(result, type(result))
# å¯ä»¥å°†Pythonçš„æ•°æ®ç±»å‹è½¬æ¢æˆå­—ç¬¦ä¸²ï¼ˆjsonæ•°æ®ï¼‰

# json.loads()
# str_1 = '{"name": "\u963f\u5c55", "gender": "\u7537"}'
# result = json.loads(str_1)
# print(result, type(result))
# å¯ä»¥è®²jsonæ•°æ®ï¼ˆå­—ç¬¦ä¸²å½¢å¼çš„å­—å…¸ï¼‰è½¬æ¢æˆå­—å…¸ç±»å‹æ•°æ®

# äº†è§£
# import json
# # å†™å…¥
# dict_1 = {'name': 'é˜¿å±•', 'gender': 'ç”·'}
# with open('1.txt', 'w')as f:
#     json.dump(dict_1,f)

# è¯»å–
# with open('1.txt', 'r')as f:
#     print(json.loads(f))
#
# dict_1 = {'name': 'é˜¿å±•', 'gender': 'ç”·'}
# with open('2.txt', 'w', encoding='utf-8')as f:
#     f.write(str(dict_1))
# with open('2.txt', 'r',encoding='utf-8')as f:
#     print(f.read())


# 3.jsonpathå®‰è£…ä½¿ç”¨
# from requests_html import HTMLSession
# from  jsonpath import jsonpath
# session = HTMLSession()

# æ¡ˆä¾‹ï¼Œå¿«æ‰‹è¯„è®ºæ­£æ–‡ï¼š

# start_url = 'https://video.kuaishou.com/graphql'
# headers = {
# 'content-type': 'application/json',
#     'Cookie': 'kpf=PC_WEB; kpn=KUAISHOU_VISION; clientid=3; did=web_516b5e505a73ea248d313c3ba769882e',
#     'Host': 'video.kuaishou.com',
#     'Origin': 'https://video.kuaishou.com',
#     'Referer': 'https://video.kuaishou.com/short-video/3xqk9kz8z59ds54?authorId=3xpbiv5ppefwdvm&streamSource=brilliant&hotChannelId=00&area=brilliantxxrecommend',
#     'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/89.0.4389.72 Safari/537.36'
# }
# data = {"operationName":"commentListQuery","variables":{"photoId":"3xqk9kz8z59ds54","pcursor":""},"query":"query commentListQuery($photoId: String, $pcursor: String) {\n  visionCommentList(photoId: $photoId, pcursor: $pcursor) {\n    commentCount\n    pcursor\n    rootComments {\n      commentId\n      authorId\n      authorName\n      content\n      headurl\n      timestamp\n      likedCount\n      realLikedCount\n      liked\n      status\n      subCommentCount\n      subCommentsPcursor\n      subComments {\n        commentId\n        authorId\n        authorName\n        content\n        headurl\n        timestamp\n        likedCount\n        realLikedCount\n        liked\n        status\n        replyToUserName\n        replyTo\n        __typename\n      }\n      __typename\n    }\n    __typename\n  }\n}\n"}
#
# response = session.post(start_url, json=data, headers=headers).json()
# print(response)
# # authorName ä½œè€…å
# # content    è¯„è®ºæ­£æ–‡
# authorName = jsonpath(response, '$..authorName') # $:æ ¹èŠ‚ç‚¹
# print(authorName)
#
# content_str = jsonpath(response, '$..content')
# print(content_str)
#
# dict_1 = [{'name': 'xiaoming', 'sex': 'g'}, {'addr': 'bj'}, {'name': 'xiaohong', 'sex': '1'}]
# # print(dict_1[0]['sex1']
#
# data = jsonpath(dict_1, '$..sex1')
#
# print(data)

# æ¡ˆä¾‹ï¼ŒæŠ–éŸ³å»æ°´å°è§†é¢‘ï¼š

# æŠ–éŸ³é“¾æ¥é›†åˆï¼š
"""
å®‰å¾½çš„å¤©å¥½å†·ï¼Œå°±åƒæˆ‘æƒ³å¤ä¹ çš„å¿ƒä¸€æ ·  https://v.douyin.com/JGACH6s/ ;å¤åˆ¶æ­¤é“¾æ¥ï¼Œæ‰“å¼€æŠ–éŸ³æœç´¢ï¼Œç›´æ¥è§‚çœ‹è§†é¢‘ï¼
å¸…ï¼å›é¡¾â€œä¹ä¸‰é˜…å…µâ€éœ‡æ’¼åœºé¢ï¼Œæ¯ä¸ªåŠ¨ä½œéƒ½åƒæ˜¯å¤åˆ¶ç²˜è´´ï¼ä¸€èµ·æœŸå¾…ï¼Œå›½åº†70å¹´å¤§é˜…å…µï¼  https://v.douyin.com/JXETnfd/ å¤åˆ¶æ­¤é“¾æ¥ï¼Œæ‰“å¼€æŠ–éŸ³æœç´¢ï¼Œç›´æ¥è§‚çœ‹è§†é¢‘ï¼
#è½»vlog #åŸƒç½—èŠ’é˜¿è€å¸ˆ çº±é›¾çš„é›·ç¥æ–©ç­å‰‘  https://v.douyin.com/JXEvGxT/ å¤åˆ¶æ­¤é“¾æ¥ï¼Œæ‰“å¼€æŠ–éŸ³æœç´¢ï¼Œç›´æ¥è§‚çœ‹è§†é¢‘ï¼
#è‹±é›„è”ç›Ÿ #ç‹—å¤´ ç”Ÿä¸æ­»è½®å›ä¸æ­¢ï¼Œå¦‚æœè”ç›Ÿæ‹æˆç”µå½±ä½ å»çœ‹å—ï¼Ÿ  https://v.douyin.com/JXEs3pS/ å¤åˆ¶æ­¤é“¾æ¥ï¼Œæ‰“å¼€æŠ–éŸ³æœç´¢ï¼Œç›´æ¥è§‚çœ‹è§†é¢‘ï¼
#å›½æ¼« #å¤©ä½¿å½¦ #å‡‰å†°  https://v.douyin.com/JXKGLng/ å¤åˆ¶æ­¤é“¾æ¥ï¼Œæ‰“å¼€æŠ–éŸ³æœç´¢ï¼Œç›´æ¥è§‚çœ‹è§†é¢‘ï¼
#æ–—ç ´è‹ç©¹ ä½ ä»¬è¦çš„ç¾æœèå¥³ç‹ï¼Œè¦å›è€å®¶é™ªå¥¶å¥¶è¿‡å¹´ï¼Œæ˜¨æ™šä¸€ä¸ªé€šå®µç†¬å‡ºæ¥çš„æ„Ÿè§‰å¾ˆå¤šåœ°æ–¹æ²¡ç”»å¥½å°†å°±ç€çœ‹å§ï¼  https://v.douyin.com/JXKx2pn/ å¤åˆ¶æ­¤é“¾æ¥ï¼Œæ‰“å¼€æŠ–éŸ³æœç´¢ï¼Œç›´æ¥è§‚çœ‹è§†é¢‘ï¼
æ¬£èµæ¥è‡ªWLOPå¤§ä½¬çš„ç¬¬äº”æ³¢ä½œå“  #wlop  #é¬¼åˆ€  #åŠ¨æ€å£çº¸  #é«˜æ¸…60å¸§  @DOU+å°åŠ©æ‰‹  https://v.douyin.com/J4PR5UP/ å¤åˆ¶æ­¤é“¾æ¥ï¼Œæ‰“å¼€æŠ–éŸ³æœç´¢ï¼Œç›´æ¥è§‚çœ‹è§†é¢‘ï¼
ç¥åŒ»å¥—è·¯å¤š %æç¬‘  %å¥—è·¯  %å¤§å…µ  %æ²™é›•  %å½±è§† å…¨0å¸§  @DOU+å°åŠ©æ‰‹  https://v.douyin.com/J4PR5UP/ å¤åˆ¶æ­¤æ‰“å¼€æŠ–éŸ³æœç´¢ï¼Œç›´æ¥è§‚çœ‹è§†é¢‘ï¼
æ›¾ç»çœŸçš„ä»¥ä¸ºäººç”Ÿå°±è¿™æ ·äº†%é¬¼è¿·å¿ƒçª %è½¦è½½éŸ³ä¹ %çƒ­é—¨éŸ³ä¹  https://v.douyin.com/JguscCJ/ å¤åˆ¶æ­¤é“¾æ¥ï¼Œæ‰“å¼€æŠ–éŸ³æœç´¢ï¼Œç›´æ¥è§‚çœ‹è§†é¢‘ï¼
è¿™ä¸ªéŸ³ä¹å¤ªä¸Šå¤´äº† %åœ£è¯èŠ‚ğŸ„ %ç§€èº«æç§€è…¿ %è¾£å¦¹@æŠ–éŸ³å°åŠ©æ‰‹  https://v.douyin.com/JgunGsT/ å¤åˆ¶æ­¤é“¾æ¥ï¼Œæ‰“å¼€æŠ–éŸ³æœç´¢ï¼Œç›´æ¥è§‚çœ‹è§†é¢‘ï¼
æ—¢ç„¶é‚£ä¹ˆå¤šäººé€ä½ åœ£è¯ç¤¼ç‰©ï¼Œé‚£å°‘æˆ‘ä¸€ä¸ªä¹Ÿæ²¡å…³ç³»äº†å§ %å°ä¸‘ç«Ÿæ˜¯æˆ‘è‡ªå·±  https://v.douyin.com/JgHRCUG/ å¤åˆ¶æ­¤é“¾æ¥ï¼Œæ‰“å¼€æŠ–éŸ³æœç´¢ï¼Œç›´æ¥è§‚çœ‹è§†é¢‘ï¼
å‡ºè½¦å—ï¼Œé©¬ä¸Šåˆ°  %é«˜æ¸…  %é›…é©¬å“ˆmt09  https://v.douyin.com/edAUSE4/ å¤åˆ¶æ­¤é“¾æ¥ï¼Œå’‘é¦DouåŸæœç´¢ï¼Œç›´æ¥è§€çœ‹è¦–é¢‘ï¼
"""
# å¯¼å…¥æ¨¡å—
from requests_html import HTMLSession
from  jsonpath import jsonpath
import re, os # å¯¼å…¥æ­£åˆ™æ¨¡å—ã€osç³»ç»Ÿæ“ä½œå‘½ä»¤æ¨¡å—
session = HTMLSession()

while True: # ä¸ºå®ç°å¤šæ¬¡è¯·æ±‚ï¼Œä½¿ç”¨whileå¾ªç¯
    start_url = input('è¯·è¾“å…¥åˆ†äº«é“¾æ¥ï¼š') # æ¥æ”¶ç”¨æˆ·è¾“å…¥çš„æŠ–éŸ³é“¾æ¥
    # start_url = '#è‹±é›„è”ç›Ÿ #ç‹—å¤´ ç”Ÿä¸æ­»è½®å›ä¸æ­¢ï¼Œå¦‚æœè”ç›Ÿæ‹æˆç”µå½±ä½ å»çœ‹å—ï¼Ÿ  https://v.douyin.com/JXEs3pS/ å¤åˆ¶æ­¤é“¾æ¥ï¼Œæ‰“å¼€æŠ–éŸ³æœç´¢ï¼Œç›´æ¥è§‚'
    # ä¸‹é¢æˆ‘ä»¬è¦é€šè¿‡æ­£åˆ™åŒ¹é…å‡ºæ­£ç¡®çš„urlåœ°å€
    # é¦–å…ˆï¼Œæˆ‘ä»¬ä½¿ç”¨re.findall()æ–¹æ³•ï¼Œå› ä¸ºfindallæ–¹æ³•è¿”å›çš„æ˜¯ä¸€ä¸ªåˆ—è¡¨ï¼Œæ‰€ä»¥æˆ‘ä»¬è¦åŠ ä¸Šç´¢å¼•ï¼ˆä¸‹æ ‡ï¼‰ï¼Œç”¨æ¥åªåŒ¹é…å‡ºé“¾æ¥éƒ¨åˆ†
    # ä¸‹é¢ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯æ­£åˆ™è§„åˆ™ï¼Œç¬¬äºŒä¸ªå‚æ•°æ˜¯æå–å¯¹è±¡
    # ç”±è§‚å¯Ÿå¯ä»¥å‘ç°ï¼Œç¬¬ä¸€ä¸ªè¦åŒ¹é…çš„å‚æ•°æ˜¯httpï¼Œç¬¬äºŒä¸ªå‚æ•°æ˜¯èµ·å§‹çš„urlåœ°å€
    # ç”±è§‚å¯Ÿå¯ä»¥å‘ç°ï¼Œæ¯ä¸€ä¸ªè§†å±é“¾æ¥åé¢éƒ½æœ‰ä¸€ä¸ªç©ºæ ¼ï¼Œæ‰€ä»¥æˆ‘ä»¬è¦åœ¨æ­£åˆ™è§„åˆ™.*?ååŠ ä¸€ä¸ªç©ºæ ¼
    # åŒæ—¶ï¼Œç”±æ‰“å°çš„è¿”å›é“¾æ¥å¯ä»¥å‘ç°ï¼Œè¿”å›çš„æ˜¯ä¸€ä¸ªåˆ—è¡¨ï¼Œé“¾æ¥æœ«å°¾æœ‰ä¸€ä¸ªç©ºæ ¼ï¼Œä¸å¤ªä¸¥è°¨
    # æ‰€ä»¥ï¼Œå‡ºäºä¸¥è°¨ï¼Œæˆ‘ä»¬åœ¨httpåé¢åŠ ä¸€ä¸ªæ‹¬å·ï¼Œæ­¤æ—¶å®ƒè¿”å›çš„å°±æ˜¯æ‹¬å·é‡Œé¢çš„å†…å®¹
    # åˆç”±è§‚å¯Ÿè¿”å›çš„å†…å®¹å¯çœ‹åˆ°ï¼Œè¿”å›çš„é“¾æ¥ç¼ºå°‘httpï¼Œæ‰€ä»¥æˆ‘ä»¬è¦åœ¨re.findallå‰é¢åŠ ä¸Šä¸€ä¸ªhttp
    # å†æ¬¡è¿è¡Œï¼Œæˆ‘ä»¬å‘ç°é“¾æ¥å·²ç»å˜å¾—å®Œæ•´äº†

    start_url = 'http' + re.findall('http(.*?) ', start_url)[0]
    # print(start_url)
    # è‡³æ­¤ï¼Œæˆ‘ä»¬èµ·å§‹çš„urlåœ°å€å·²ç»å‡†å¤‡å®Œæ•´äº†ï¼Œä¸‹é¢æˆ‘ä»¬è¿›å…¥å‘é€è¯·æ±‚ã€è·å–å“åº”ç¯èŠ‚äº†

    # æ­¤æ—¶ï¼Œæˆ‘ä»¬æ„é€ headerså°±éœ€è¦æŠ€å·§äº†ï¼Œå› ä¸ºæˆ‘ä»¬è§‚å¯Ÿé“¾æ¥çš„previewå¯å‘ç°ï¼Œæ²¡æœ‰ä»»ä½•å“åº”ä¿¡æ¯ï¼Œ
    # æ‰€ä»¥è§†å±æ˜¯ç”±å¼‚æ­¥åŠ è½½æ¸²æŸ“ä¸Šå»çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬è¦è§‚å¯Ÿå¼‚æ­¥åŠ è½½çš„xhrå°é»„äººï¼Œå†æ¬¡è§‚å¯Ÿpreviewï¼Œ
    # å‘ç°åŒ…çš„ä¿¡æ¯å¾ˆå¤šï¼Œå¾ˆæœ‰å¯èƒ½æœ‰æˆ‘ä»¬è¦æ‰¾çš„ä¸œè¥¿ï¼Œæ‰€ä»¥ï¼Œæˆ‘ä»¬å±•å¼€å€¼ï¼Œå¯¹æ¯”é“¾æ¥å…³é”®è¯ï¼Œå³å¯æ‰¾åˆ°å¯¹åº”çš„åŒ…
    # æ‰€ä»¥ï¼Œæˆ‘ä»¬ç›´æ¥ç‚¹å‡»å³ä¸Šè§’ä¸‰ç‚¹å·ï¼Œç‚¹å‡»æœç´¢ï¼ŒæŸ¥æ‰¾MP4ï¼Œæ‰¾åˆ°MP4çš„url
    # é€šè¿‡æœç´¢ï¼Œæˆ‘ä»¬æ²¡æœ‰æ‰¾åˆ°ä»»ä½•mp4ç›¸å…³ä¿¡æ¯ï¼Œå…¶å®è¿™æ˜¯è°·æ­ŒæŠ“åŒ…æœç´¢çš„å¼Šç«¯ï¼Œæˆ‘ä»¬æ‰¾åˆ°responseé‡Œé¢çš„å­—ç¬¦ä¸²ï¼Œ
    # æŠŠå†…å®¹å¤åˆ¶ï¼Œåœ¨è°·æ­Œæ‰“å¼€jsonè§£ææ–°çª—å£ï¼Œè§£æåå†æ¬¡æœç´¢ï¼Œå‘ç°ä¹Ÿæ²¡æœ‰MP4ç›¸å…³å†…å®¹ï¼Œ
    # æˆ‘ä»¬ä¹Ÿä¸ç”¨æ‹…å¿ƒï¼Œæˆ‘ä»¬è¿”å›æŠ–éŸ³æŠ“åŒ…ï¼Œå‘ç°æœ‰è§†é¢‘çš„æ ‡å¿—æ€§videoï¼Œåœ¨videoé‡Œé¢æŸ¥æ‰¾ï¼Œçœ‹çœ‹æ˜¯å¦èƒ½æ‰¾åˆ°MP4ä¿¡æ¯
    # æˆ‘ä»¬æ‰¾åˆ°è¿™ä¸ªé“¾æ¥ï¼š
    # "https://aweme.snssdk.com/aweme/v1/playwm/?video_id=v0200f210000bhtq8nuvld7ce16r2ou0&ratio=720p&line=0"
    # é€šè¿‡è®¿é—®æ­¤é“¾æ¥ï¼Œæˆ‘ä»¬å‘ç°è¿™ä¸ªé“¾æ¥å°±æ˜¯è§†é¢‘æ’­æ”¾é“¾æ¥ï¼Œä½†æ˜¯æœ‰æ°´å°ï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬è¿›å…¥é™¤æ°´å°ç¯èŠ‚
    # æŠ–éŸ³çš„æ°´å°æ ‡å¿—ä¸ºé“¾æ¥é‡Œé¢playåé¢çš„wmï¼Œåˆ é™¤wmå³å¯é™¤æ°´å°
    # é€šè¿‡åˆ é™¤wmï¼Œæˆ‘ä»¬å‘ç°æ°´å°å·²ç»æˆåŠŸå»é™¤
    # åœ¨æ­¤æˆ‘ä»¬å¾—å‡ºç»“è®ºï¼ŒæŠ–éŸ³é™¤æ°´å°æœºåˆ¶å…¶å®å¾ˆç®€å•ï¼š
    # æˆ‘ä»¬å…ˆå¯¹èµ·å§‹çš„urlåœ°å€å‘é€è¯·æ±‚ï¼Œè·å–å“åº”ï¼Œå®ƒä¼šè¢«åšä¸€ä¸ªé‡å®šå‘çš„æ“ä½œï¼Œé‡å®šå‘ä¹‹åï¼Œè¿›è¡Œå¼‚æ­¥æŠ“åŒ…ï¼Œ
    # è·å–ç›¸åº”çš„jsonæ•°æ®ï¼Œæ‰¾åˆ°è§†é¢‘é“¾æ¥ï¼Œè¿›è¡Œplayåé¢çš„wmåˆ é™¤æ“ä½œï¼Œè·å¾—åˆ°æ— æ°´å°è§†é¢‘
    # ç„¶åä¿å­˜æ— æ°´å°é“¾æ¥çš„äºŒè¿›åˆ¶æ•°æ®ï¼Œå³å¯ã€‚
    # ä¸‹é¢ï¼Œæˆ‘ä»¬è¿›å…¥å†™ä»£ç ç¯èŠ‚ï¼š
    headers = {
        'user-agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/89.0.4389.82 Safari/537.36'
    }
    # è·å–å“åº”çš„urlåœ°å€
    response_url = session.get(start_url, headers=headers).url
    # æå–id
    item_id = re.findall('video/(.*?)/', response_url)[0]
    # æå–åˆ°è§†å±çš„id
    # print(item_id)
    # urlåœ°å€æ‹¼æ¥ï¼ˆå­—ç¬¦ä¸²çš„æ‹¼æ¥ï¼šæˆ–è€…ä½¿ç”¨åŠ å·ï¼‰
    next_url = f'https://www.iesdouyin.com/web/api/v2/aweme/iteminfo/?item_ids={item_id}'
    # é€šè¿‡å­—ç¬¦ä¸²æ‹¼æ¥ï¼Œå°†ä¸Šé¢urlåœ°å€idæˆåŠŸæ‹¼æ¥ï¼Œæ‹¼æ¥å®Œæˆä¹‹åï¼Œæˆ‘ä»¬è·å–åˆ°äº†æ–°çš„urlåœ°å€ï¼Œ
    # ä¸‹é¢ï¼Œæˆ‘ä»¬å¯¹æ–°çš„urlåœ°å€å‘é€è¯·æ±‚ï¼Œè·å–åˆ°çš„å°±æ˜¯jsonæ•°æ®ï¼Œä¸‹é¢æˆ‘ä»¬ä½¿ç”¨jaon_dataæ¥æ¥æ”¶jsonæ•°æ®ï¼Œ
    # ä¼ å…¥next_urlï¼Œè°ƒç”¨json()æ–¹æ³•

    json_data = session.get(next_url).json()
    # print(json_data) # æ‰“å°ä¸€ä¸‹json_data
    # é€šè¿‡æ‰“å°ï¼Œæˆ‘ä»¬å‘ç°å·²ç»æˆåŠŸè·å–åˆ°äº†jsonæ•°æ®
    # ä¸‹é¢ï¼Œæˆ‘ä»¬ä»jsonæ•°æ®ä¸­è·å–æˆ‘ä»¬éœ€è¦çš„ä¿¡æ¯ï¼Œæ¥ä¸‹æ¥å°±æ˜¯æ•°æ®æå–ç¯èŠ‚

    # æ•°æ®æå–æˆ‘ä»¬å°±ç”¨åˆ°æˆ‘ä»¬ä»Šå¤©æ‰€å­¦çš„jsonpathï¼Œæˆ‘ä»¬å¯¼å…¥jsonpathæ¨¡å—ï¼šfrom jsonpath import jsonpath
    # é¦–å…ˆï¼Œæˆ‘ä»¬ä»jsonæ•°æ®ä¸­çœ‹åˆ°äº†titleï¼Œå’Œdescï¼Œé¦–å…ˆï¼Œæˆ‘ä»¬ä½¿ç”¨descï¼Œä¼ å…¥json_data
    # åœ¨descåé¢åŠ å…¥æå–è§„åˆ™ï¼š'$..desc',æ‰“å°descï¼Œæˆ‘ä»¬å‘ç°æ‰“å°å‡ºçš„æ•°æ®æœ«å°¾æœ‰ä¸€ä¸ªç©ºæ ¼ï¼Œ
    # æ‰€ä»¥ï¼Œä¸€ä¸ªdescå¯¹åº”ä¸€ä¸ª''ç©ºæ ¼ï¼Œä¸‹é¢æˆ‘ä»¬ç”¨share_titleæå–ï¼Œå‘ç°æ‰“å°å‡ºçš„æ˜¯è§†é¢‘æ ‡é¢˜ï¼Œ
    # æ‰€ä»¥ï¼Œç”¨share_titleä½œä¸ºæå–æ ‡é¢˜æ²¡æœ‰é—®é¢˜ï¼Œæ‰€ä»¥ï¼Œæˆ‘ä»¬æˆåŠŸæ‰¾åˆ°äº†æå–æ ‡é¢˜


    # æ•°æ®æå–
    # æå–æ ‡é¢˜
    share_title = jsonpath(json_data, '$..share_title')[0]
    # print(share_title)

    # æ¥ä¸‹æ¥ï¼Œå°±æ˜¯è§†å±çš„urlåœ°å€
    # æˆ‘ä»¬é€šè¿‡æ‰“å°çš„jsonæ•°æ®å‘ç°ï¼Œè§†é¢‘çš„åœ°å€å¤šè¾¾13ä¸ªï¼Œæ‰€ä»¥ï¼Œéœ€è¦è¿›è¡Œè¿‡æ»¤ï¼Œ
    # è¿‡æ»¤å¤ªéº»çƒ¦ï¼Œæˆ‘ä»¬å¯ä»¥æ¢ä¸€ç§æå–æ–¹å¼
    # æˆ‘ä»¬è¿”å›æŠ“åŒ…ç½‘é¡µå‘ç°ï¼Œurlæ˜¯åœ¨play_addré‡Œé¢çš„ï¼Œæ‰€ä»¥ï¼Œæˆ‘ä»¬å¯ä»¥åšäºŒçº§æå–ï¼Œ
    # é¦–å…ˆï¼Œå°†è¿™ä¸ªplay_addræ‰€å¯¹åº”çš„å­—å…¸æå–å‡ºæ¥ï¼šplay_adder = jsonpath(json_data, '$..play_adder')
    # æå–ä¹‹åå®ƒè¿˜æ˜¯ä¸€ä¸ªå­—å…¸æ•°æ®ï¼Œæ‰€ä»¥æˆ‘ä»¬è¿˜éœ€è¦åšä¸€æ¬¡play_addræå–ï¼šç„¶åæå–url_list:url = jsonpath(play_adder, '$..url_list')

    # æå–æ’­æ”¾åœ°å€
    play_addr = jsonpath(json_data, '$..play_addr') # æå–play_addræ‰€å¯¹åº”çš„å­—å…¸
    url = jsonpath(play_addr, '$..url_list')[0][0]
    # print(url) æ‰“å°å‡ºæ¥çš„å°±æ˜¯æ— æ°´å°urlåœ°å€
    # è§‚å¯Ÿæ‰“å°ç»“æœï¼Œæˆ‘ä»¬å‘ç°å®ƒæœ‰ä¸¤å±‚åˆ—è¡¨ï¼Œè¿™æ˜¯å› ä¸ºæˆ‘ä»¬çš„jsonpathè¿”å›çš„æ•°æ®æ˜¯ä¸€ä¸ªåˆ—è¡¨ï¼Œ
    # æ‰€ä»¥æˆ‘ä»¬è¦åšä¸€ä¸ªä¸‹æ ‡ï¼ˆç´¢å¼•ï¼‰çš„æ“ä½œï¼Œåªæå–åˆ—è¡¨éƒ¨åˆ†ï¼šurl = jsonpath(play_adder, '$..url_list')[0][0]
    # æ­¤æ—¶æ‰“å°çš„å°±æ˜¯æœ‰æ•ˆé“¾æ¥éƒ¨åˆ†äº†ï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬å°±è¦è¿›è¡Œwmåˆ é™¤æ“ä½œäº†

    # æˆ‘ä»¬ä½¿ç”¨MP4_urlæ¥æ¥æ”¶æ›¿æ¢æ“ä½œ
    # ä¸ºäº†é¿å…wmè¯¯åˆ ï¼Œæˆ‘ä»¬è¦å°†playwmæ›¿æ¢ä¸ºplay
    mp4_url = url.replace('playwm', 'play')

    # æ— æ°´å°åœ°å€æ‹¿åˆ°ä¹‹åï¼Œæˆ‘ä»¬åªéœ€å¯¹æ— æ°´å°åœ°å€å‘é€è¯·æ±‚ï¼Œè·å–å®ƒçš„äºŒè¿›åˆ¶æ•°æ®ï¼š
    data = session.get(mp4_url).content # .content:ç”¨æ¥è·å–äºŒè¿›åˆ¶æ•°æ®

    # æ¥ä¸‹æ¥å°±æ˜¯è§†é¢‘çš„ä¿å­˜ï¼šwith open(os_path + share_title + '.mp4', 'wb')as f:  f.write(data)
    # åˆ›å»ºä¸€ä¸ªä¿å­˜è§†é¢‘çš„æ–‡ä»¶å¤¹ï¼š
    os_path = os.getcwd() + '/dy/' # æ–‡ä»¶å¤¹ååè¦åŠ æ–œæ ,getcwd:è·å–å½“å‰è·¯å¾„
    # å¦‚æœä¿å­˜è·¯å¾„ä¸å­˜åœ¨ï¼Œå°±æŒ‰æŒ‡å®šè·¯å¾„åˆ›å»ºä¸€ä¸ªæ–‡ä»¶å¤¹ï¼š
    if not os.path.exists(os_path):
        os.mkdir(os_path) # mkdirï¼šåˆ›å»ºç›®å½•
    # è§†é¢‘çš„æ ‡é¢˜ + è§†é¢‘çš„æ ¼å¼
    with open(os_path + share_title + '.mp4', 'wb')as f:
        f.write(data)
    # åŠ å…¥ä¿å­˜æç¤ºï¼š
    print(f'{share_title}----ä¿å­˜å®Œæˆ')

